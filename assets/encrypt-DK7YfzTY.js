import{d as St}from"./index-G52ltOKd.js";let x;if(!globalThis.IS_MP_BUILD){let b=function(a){return Et.charAt(a)},P=function(a,t){return a&t},q=function(a,t){return a|t},Q=function(a,t){return a^t},tt=function(a,t){return a&~t},lt=function(a){if(a==0)return-1;var t=0;return a&65535||(a>>=16,t+=16),a&255||(a>>=8,t+=8),a&15||(a>>=4,t+=4),a&3||(a>>=2,t+=2),a&1||++t,t},vt=function(a){for(var t=0;a!=0;)a&=a-1,++t;return t},W=function(a){var t,e,i="";for(t=0;t+3<=a.length;t+=3)e=parseInt(a.substring(t,t+3),16),i+=R.charAt(e>>6)+R.charAt(e&63);for(t+1==a.length?(e=parseInt(a.substring(t,t+1),16),i+=R.charAt(e<<2)):t+2==a.length&&(e=parseInt(a.substring(t,t+2),16),i+=R.charAt(e>>2)+R.charAt((e&3)<<4));(i.length&3)>0;)i+=ht;return i},et=function(a){var t="",e,i=0,r=0;for(e=0;e<a.length&&a.charAt(e)!=ht;++e){var s=R.indexOf(a.charAt(e));s<0||(i==0?(t+=b(s>>2),r=s&3,i=1):i==1?(t+=b(r<<2|s>>4),r=s&15,i=2):i==2?(t+=b(r),t+=b(s>>2),r=s&3,i=3):(t+=b(r<<2|s>>4),t+=b(s&15),i=0))}return i==1&&(t+=b(r<<2)),t},M=function(a,t){return a.length>t&&(a=a.substring(0,t)+nt),a},l=function(){return new f(null)},d=function(a,t){return new f(a,t)},ct=function(a,t,e,i,r,s){for(;--s>=0;){var h=t*this[a++]+e[i]+r;r=Math.floor(h/67108864),e[i++]=h&67108863}return r},pt=function(a,t,e,i,r,s){for(var h=t&32767,n=t>>15;--s>=0;){var o=this[a]&32767,u=this[a++]>>15,v=n*o+u*h;o=h*o+((v&32767)<<15)+e[i]+(r&1073741823),r=(o>>>30)+(v>>>15)+n*u+(r>>>30),e[i++]=o&1073741823}return r},dt=function(a,t,e,i,r,s){for(var h=t&16383,n=t>>14;--s>=0;){var o=this[a]&16383,u=this[a++]>>14,v=n*o+u*h;o=h*o+((v&16383)<<14)+e[i]+r,r=(o>>28)+(v>>14)+n*u,e[i++]=o&268435455}return r},rt=function(a,t){var e=H[a.charCodeAt(t)];return e??-1},O=function(a){var t=l();return t.fromInt(a),t},F=function(a){var t=1,e;return(e=a>>>16)!=0&&(a=e,t+=16),(e=a>>8)!=0&&(a=e,t+=8),(e=a>>4)!=0&&(a=e,t+=4),(e=a>>2)!=0&&(a=e,t+=2),(e=a>>1)!=0&&(a=e,t+=1),t},gt=function(){return new mt},Tt=function(){if(z==null){for(z=gt();E<ut;){var a=Math.floor(65536*Math.random());B[E++]=a&255}for(z.init(B),E=0;E<B.length;++E)B[E]=0;E=0}return z.next()},yt=function(a,t){if(t<a.length+11)return console.error("Message too long for RSA"),null;for(var e=[],i=a.length-1;i>=0&&t>0;){var r=a.charCodeAt(i--);r<128?e[--t]=r:r>127&&r<2048?(e[--t]=r&63|128,e[--t]=r>>6|192):(e[--t]=r&63|128,e[--t]=r>>6&63|128,e[--t]=r>>12|224)}e[--t]=0;for(var s=new X,h=[];t>2;){for(h[0]=0;h[0]==0;)s.nextBytes(h);e[--t]=h[0]}return e[--t]=2,e[--t]=0,new f(e)},bt=function(a,t){for(var e=a.toByteArray(),i=0;i<e.length&&e[i]==0;)++i;if(e.length-i!=t-1||e[i]!=2)return null;for(++i;e[i]!=0;)if(++i>=e.length)return null;for(var r="";++i<e.length;){var s=e[i]&255;s<128?r+=String.fromCharCode(s):s>191&&s<224?(r+=String.fromCharCode((s&31)<<6|e[i+1]&63),++i):(r+=String.fromCharCode((s&15)<<12|(e[i+1]&63)<<6|e[i+2]&63),i+=2)}return r};const D=typeof globalThis<"u"?globalThis.navigator:window.globalThis;var Et="0123456789abcdefghijklmnopqrstuvwxyz",R="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",ht="=",I,Dt={decode:function(a){var t;if(I===void 0){var e="0123456789ABCDEF",i=` \f
\r	 \u2028\u2029`;for(I={},t=0;t<16;++t)I[e.charAt(t)]=t;for(e=e.toLowerCase(),t=10;t<16;++t)I[e.charAt(t)]=t;for(t=0;t<i.length;++t)I[i.charAt(t)]=-1}var r=[],s=0,h=0;for(t=0;t<a.length;++t){var n=a.charAt(t);if(n=="=")break;if(n=I[n],n!=-1){if(n===void 0)throw new Error("Illegal character at offset "+t);s|=n,++h>=2?(r[r.length]=s,s=0,h=0):s<<=4}}if(h)throw new Error("Hex encoding incomplete: 4 bits missing");return r}},U,$={decode:function(a){var t;if(U===void 0){var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=`= \f
\r	 \u2028\u2029`;for(U=Object.create(null),t=0;t<64;++t)U[e.charAt(t)]=t;for(t=0;t<i.length;++t)U[i.charAt(t)]=-1}var r=[],s=0,h=0;for(t=0;t<a.length;++t){var n=a.charAt(t);if(n=="=")break;if(n=U[n],n!=-1){if(n===void 0)throw new Error("Illegal character at offset "+t);s|=n,++h>=4?(r[r.length]=s>>16,r[r.length]=s>>8&255,r[r.length]=s&255,s=0,h=0):s<<=6}}switch(h){case 1:throw new Error("Base64 encoding incomplete: at least 2 bits missing");case 2:r[r.length]=s>>10;break;case 3:r[r.length]=s>>16,r[r.length]=s>>8&255;break}return r},re:/-----BEGIN [^-]+-----([A-Za-z0-9+\/=\s]+)-----END [^-]+-----|begin-base64[^\n]+\n([A-Za-z0-9+\/=\s]+)====/,unarmor:function(a){var t=$.re.exec(a);if(t)if(t[1])a=t[1];else if(t[2])a=t[2];else throw new Error("RegExp out of sync");return $.decode(a)}},V=1e13;class L{constructor(t){this.buf=[+t||0]}mulAdd(t,e){var i=this.buf,r=i.length,s,h;for(s=0;s<r;++s)h=i[s]*t+e,h<V?e=0:(e=0|h/V,h-=e*V),i[s]=h;e>0&&(i[s]=e)}sub(t){var e=this.buf,i=e.length,r,s;for(r=0;r<i;++r)s=e[r]-t,s<0?(s+=V,t=1):t=0,e[r]=s;for(;e[e.length-1]===0;)e.pop()}toString(t){if((t||10)!=10)throw new Error("only base 10 is supported");for(var e=this.buf,i=e[e.length-1].toString(),r=e.length-2;r>=0;--r)i+=(V+e[r]).toString().substring(1);return i}valueOf(){for(var t=this.buf,e=0,i=t.length-1;i>=0;--i)e=e*V+t[i];return e}simplify(){var t=this.buf;return t.length==1?t[0]:this}}var nt="…",xt=/^(\d\d)(0[1-9]|1[0-2])(0[1-9]|[12]\d|3[01])([01]\d|2[0-3])(?:([0-5]\d)(?:([0-5]\d)(?:[.,](\d{1,3}))?)?)?(Z|[-+](?:[0]\d|1[0-2])([0-5]\d)?)?$/,Ot=/^(\d\d\d\d)(0[1-9]|1[0-2])(0[1-9]|[12]\d|3[01])([01]\d|2[0-3])(?:([0-5]\d)(?:([0-5]\d)(?:[.,](\d{1,3}))?)?)?(Z|[-+](?:[0]\d|1[0-2])([0-5]\d)?)?$/;class K{constructor(t,e){this.hexDigits="0123456789ABCDEF",t instanceof K?(this.enc=t.enc,this.pos=t.pos):(this.enc=t,this.pos=e)}get(t){if(t===void 0&&(t=this.pos++),t>=this.enc.length)throw new Error("Requesting byte offset "+t+" on a stream of length "+this.enc.length);return typeof this.enc=="string"?this.enc.charCodeAt(t):this.enc[t]}hexByte(t){return this.hexDigits.charAt(t>>4&15)+this.hexDigits.charAt(t&15)}hexDump(t,e,i){for(var r="",s=t;s<e;++s)if(r+=this.hexByte(this.get(s)),i!==!0)switch(s&15){case 7:r+="  ";break;case 15:r+=`
`;break;default:r+=" "}return r}isASCII(t,e){for(var i=t;i<e;++i){var r=this.get(i);if(r<32||r>176)return!1}return!0}parseStringISO(t,e){for(var i="",r=t;r<e;++r)i+=String.fromCharCode(this.get(r));return i}parseStringUTF(t,e){for(var i="",r=t;r<e;){var s=this.get(r++);s<128?i+=String.fromCharCode(s):s>191&&s<224?i+=String.fromCharCode((s&31)<<6|this.get(r++)&63):i+=String.fromCharCode((s&15)<<12|(this.get(r++)&63)<<6|this.get(r++)&63)}return i}parseStringBMP(t,e){for(var i="",r,s,h=t;h<e;)r=this.get(h++),s=this.get(h++),i+=String.fromCharCode(r<<8|s);return i}parseTime(t,e,i){var r=this.parseStringISO(t,e),s=(i?xt:Ot).exec(r);return s?(i&&(s[1]=+s[1],s[1]+=+s[1]<70?2e3:1900),r=s[1]+"-"+s[2]+"-"+s[3]+" "+s[4],s[5]&&(r+=":"+s[5],s[6]&&(r+=":"+s[6],s[7]&&(r+="."+s[7]))),s[8]&&(r+=" UTC",s[8]!="Z"&&(r+=s[8],s[9]&&(r+=":"+s[9]))),r):"Unrecognized time: "+r}parseInteger(t,e){for(var i=this.get(t),r=i>127,s=r?255:0,h,n="";i==s&&++t<e;)i=this.get(t);if(h=e-t,h===0)return r?-1:0;if(h>4){for(n=i,h<<=3;!((+n^s)&128);)n=+n<<1,--h;n="("+h+` bit)
`}r&&(i=i-256);for(var o=new L(i),u=t+1;u<e;++u)o.mulAdd(256,this.get(u));return n+o.toString()}parseBitString(t,e,i){for(var r=this.get(t),s=(e-t-1<<3)-r,h="("+s+` bit)
`,n="",o=t+1;o<e;++o){for(var u=this.get(o),v=o==e-1?r:0,p=7;p>=v;--p)n+=u>>p&1?"1":"0";if(n.length>i)return h+M(n,i)}return h+n}parseOctetString(t,e,i){if(this.isASCII(t,e))return M(this.parseStringISO(t,e),i);var r=e-t,s="("+r+` byte)
`;i/=2,r>i&&(e=t+i);for(var h=t;h<e;++h)s+=this.hexByte(this.get(h));return r>i&&(s+=nt),s}parseOID(t,e,i){for(var r="",s=new L,h=0,n=t;n<e;++n){var o=this.get(n);if(s.mulAdd(128,o&127),h+=7,!(o&128)){if(r==="")if(s=s.simplify(),s instanceof L)s.sub(80),r="2."+s.toString();else{var u=s<80?s<40?0:1:2;r=u+"."+(s-u*40)}else r+="."+s.toString();if(r.length>i)return M(r,i);s=new L,h=0}}return h>0&&(r+=".incomplete"),r}}class C{constructor(t,e,i,r,s){if(!(r instanceof it))throw new Error("Invalid tag value.");this.stream=t,this.header=e,this.length=i,this.tag=r,this.sub=s}typeName(){switch(this.tag.tagClass){case 0:switch(this.tag.tagNumber){case 0:return"EOC";case 1:return"BOOLEAN";case 2:return"INTEGER";case 3:return"BIT_STRING";case 4:return"OCTET_STRING";case 5:return"NULL";case 6:return"OBJECT_IDENTIFIER";case 7:return"ObjectDescriptor";case 8:return"EXTERNAL";case 9:return"REAL";case 10:return"ENUMERATED";case 11:return"EMBEDDED_PDV";case 12:return"UTF8String";case 16:return"SEQUENCE";case 17:return"SET";case 18:return"NumericString";case 19:return"PrintableString";case 20:return"TeletexString";case 21:return"VideotexString";case 22:return"IA5String";case 23:return"UTCTime";case 24:return"GeneralizedTime";case 25:return"GraphicString";case 26:return"VisibleString";case 27:return"GeneralString";case 28:return"UniversalString";case 30:return"BMPString"}return"Universal_"+this.tag.tagNumber.toString();case 1:return"Application_"+this.tag.tagNumber.toString();case 2:return"["+this.tag.tagNumber.toString()+"]";case 3:return"Private_"+this.tag.tagNumber.toString()}}content(t){if(this.tag===void 0)return null;t===void 0&&(t=1/0);var e=this.posContent(),i=Math.abs(this.length);if(!this.tag.isUniversal())return this.sub!==null?"("+this.sub.length+" elem)":this.stream.parseOctetString(e,e+i,t);switch(this.tag.tagNumber){case 1:return this.stream.get(e)===0?"false":"true";case 2:return this.stream.parseInteger(e,e+i);case 3:return this.sub?"("+this.sub.length+" elem)":this.stream.parseBitString(e,e+i,t);case 4:return this.sub?"("+this.sub.length+" elem)":this.stream.parseOctetString(e,e+i,t);case 6:return this.stream.parseOID(e,e+i,t);case 16:case 17:return this.sub!==null?"("+this.sub.length+" elem)":"(no elem)";case 12:return M(this.stream.parseStringUTF(e,e+i),t);case 18:case 19:case 20:case 21:case 22:case 26:return M(this.stream.parseStringISO(e,e+i),t);case 30:return M(this.stream.parseStringBMP(e,e+i),t);case 23:case 24:return this.stream.parseTime(e,e+i,this.tag.tagNumber==23)}return null}toString(){return this.typeName()+"@"+this.stream.pos+"[header:"+this.header+",length:"+this.length+",sub:"+(this.sub===null?"null":this.sub.length)+"]"}toPrettyString(t){t===void 0&&(t="");var e=t+this.typeName()+" @"+this.stream.pos;if(this.length>=0&&(e+="+"),e+=this.length,this.tag.tagConstructed?e+=" (constructed)":this.tag.isUniversal()&&(this.tag.tagNumber==3||this.tag.tagNumber==4)&&this.sub!==null&&(e+=" (encapsulates)"),e+=`
`,this.sub!==null){t+="  ";for(var i=0,r=this.sub.length;i<r;++i)e+=this.sub[i].toPrettyString(t)}return e}posStart(){return this.stream.pos}posContent(){return this.stream.pos+this.header}posEnd(){return this.stream.pos+this.header+Math.abs(this.length)}toHexString(){return this.stream.hexDump(this.posStart(),this.posEnd(),!0)}static decodeLength(t){var e=t.get(),i=e&127;if(i==e)return i;if(i>6)throw new Error("Length over 48 bits not supported at position "+(t.pos-1));if(i===0)return null;e=0;for(var r=0;r<i;++r)e=e*256+t.get();return e}getHexStringValue(){var t=this.toHexString(),e=this.header*2,i=this.length*2;return t.substr(e,i)}static decode(t){var e;t instanceof K?e=t:e=new K(t,0);var i=new K(e),r=new it(e),s=C.decodeLength(e),h=e.pos,n=h-i.pos,o=null,u=function(){var p=[];if(s!==null){for(var c=h+s;e.pos<c;)p[p.length]=C.decode(e);if(e.pos!=c)throw new Error("Content size is not correct for container starting at offset "+h)}else try{for(;;){var m=C.decode(e);if(m.tag.isEOC())break;p[p.length]=m}s=h-e.pos}catch(y){throw new Error("Exception while decoding undefined length content: "+y)}return p};if(r.tagConstructed)o=u();else if(r.isUniversal()&&(r.tagNumber==3||r.tagNumber==4))try{if(r.tagNumber==3&&e.get()!=0)throw new Error("BIT STRINGs with unused bits cannot encapsulate.");o=u();for(var v=0;v<o.length;++v)if(o[v].tag.isEOC())throw new Error("EOC is not supposed to be actual content.")}catch{o=null}if(o===null){if(s===null)throw new Error("We can't skip over an invalid tag with undefined length at offset "+h);e.pos=h+Math.abs(s)}return new C(i,n,s,r,o)}}class it{constructor(t){var e=t.get();if(this.tagClass=e>>6,this.tagConstructed=(e&32)!==0,this.tagNumber=e&31,this.tagNumber==31){var i=new L;do e=t.get(),i.mulAdd(128,e&127);while(e&128);this.tagNumber=i.simplify()}}isUniversal(){return this.tagClass===0}isEOC(){return this.tagClass===0&&this.tagNumber===0}}var N,At=0xdeadbeefcafe,at=(At&16777215)==15715070,T=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],Nt=(1<<26)/T[T.length-1];class f{constructor(t,e,i){t!=null&&(typeof t=="number"?this.fromNumber(t,e,i):e==null&&typeof t!="string"?this.fromString(t,256):this.fromString(t,e))}toString(t){if(this.s<0)return"-"+this.negate().toString(t);var e;if(t==16)e=4;else if(t==8)e=3;else if(t==2)e=1;else if(t==32)e=5;else if(t==4)e=2;else return this.toRadix(t);var i=(1<<e)-1,r,s=!1,h="",n=this.t,o=this.DB-n*this.DB%e;if(n-- >0)for(o<this.DB&&(r=this[n]>>o)>0&&(s=!0,h=b(r));n>=0;)o<e?(r=(this[n]&(1<<o)-1)<<e-o,r|=this[--n]>>(o+=this.DB-e)):(r=this[n]>>(o-=e)&i,o<=0&&(o+=this.DB,--n)),r>0&&(s=!0),s&&(h+=b(r));return s?h:"0"}negate(){var t=l();return f.ZERO.subTo(this,t),t}abs(){return this.s<0?this.negate():this}compareTo(t){var e=this.s-t.s;if(e!=0)return e;var i=this.t;if(e=i-t.t,e!=0)return this.s<0?-e:e;for(;--i>=0;)if((e=this[i]-t[i])!=0)return e;return 0}bitLength(){return this.t<=0?0:this.DB*(this.t-1)+F(this[this.t-1]^this.s&this.DM)}mod(t){var e=l();return this.abs().divRemTo(t,null,e),this.s<0&&e.compareTo(f.ZERO)>0&&t.subTo(e,e),e}modPowInt(t,e){var i;return t<256||e.isEven()?i=new ot(e):i=new ft(e),this.exp(t,i)}clone(){var t=l();return this.copyTo(t),t}intValue(){if(this.s<0){if(this.t==1)return this[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this[0];if(this.t==0)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]}byteValue(){return this.t==0?this.s:this[0]<<24>>24}shortValue(){return this.t==0?this.s:this[0]<<16>>16}signum(){return this.s<0?-1:this.t<=0||this.t==1&&this[0]<=0?0:1}toByteArray(){var t=this.t,e=[];e[0]=this.s;var i=this.DB-t*this.DB%8,r,s=0;if(t-- >0)for(i<this.DB&&(r=this[t]>>i)!=(this.s&this.DM)>>i&&(e[s++]=r|this.s<<this.DB-i);t>=0;)i<8?(r=(this[t]&(1<<i)-1)<<8-i,r|=this[--t]>>(i+=this.DB-8)):(r=this[t]>>(i-=8)&255,i<=0&&(i+=this.DB,--t)),r&128&&(r|=-256),s==0&&(this.s&128)!=(r&128)&&++s,(s>0||r!=this.s)&&(e[s++]=r);return e}equals(t){return this.compareTo(t)==0}min(t){return this.compareTo(t)<0?this:t}max(t){return this.compareTo(t)>0?this:t}and(t){var e=l();return this.bitwiseTo(t,P,e),e}or(t){var e=l();return this.bitwiseTo(t,q,e),e}xor(t){var e=l();return this.bitwiseTo(t,Q,e),e}andNot(t){var e=l();return this.bitwiseTo(t,tt,e),e}not(){for(var t=l(),e=0;e<this.t;++e)t[e]=this.DM&~this[e];return t.t=this.t,t.s=~this.s,t}shiftLeft(t){var e=l();return t<0?this.rShiftTo(-t,e):this.lShiftTo(t,e),e}shiftRight(t){var e=l();return t<0?this.lShiftTo(-t,e):this.rShiftTo(t,e),e}getLowestSetBit(){for(var t=0;t<this.t;++t)if(this[t]!=0)return t*this.DB+lt(this[t]);return this.s<0?this.t*this.DB:-1}bitCount(){for(var t=0,e=this.s&this.DM,i=0;i<this.t;++i)t+=vt(this[i]^e);return t}testBit(t){var e=Math.floor(t/this.DB);return e>=this.t?this.s!=0:(this[e]&1<<t%this.DB)!=0}setBit(t){return this.changeBit(t,q)}clearBit(t){return this.changeBit(t,tt)}flipBit(t){return this.changeBit(t,Q)}add(t){var e=l();return this.addTo(t,e),e}subtract(t){var e=l();return this.subTo(t,e),e}multiply(t){var e=l();return this.multiplyTo(t,e),e}divide(t){var e=l();return this.divRemTo(t,e,null),e}remainder(t){var e=l();return this.divRemTo(t,null,e),e}divideAndRemainder(t){var e=l(),i=l();return this.divRemTo(t,e,i),[e,i]}modPow(t,e){var i=t.bitLength(),r,s=O(1),h;if(i<=0)return s;i<18?r=1:i<48?r=3:i<144?r=4:i<768?r=5:r=6,i<8?h=new ot(e):e.isEven()?h=new Pt(e):h=new ft(e);var n=[],o=3,u=r-1,v=(1<<r)-1;if(n[1]=h.convert(this),r>1){var p=l();for(h.sqrTo(n[1],p);o<=v;)n[o]=l(),h.mulTo(p,n[o-2],n[o]),o+=2}var c=t.t-1,m,y=!0,g=l(),S;for(i=F(t[c])-1;c>=0;){for(i>=u?m=t[c]>>i-u&v:(m=(t[c]&(1<<i+1)-1)<<u-i,c>0&&(m|=t[c-1]>>this.DB+i-u)),o=r;!(m&1);)m>>=1,--o;if((i-=o)<0&&(i+=this.DB,--c),y)n[m].copyTo(s),y=!1;else{for(;o>1;)h.sqrTo(s,g),h.sqrTo(g,s),o-=2;o>0?h.sqrTo(s,g):(S=s,s=g,g=S),h.mulTo(g,n[m],s)}for(;c>=0&&!(t[c]&1<<i);)h.sqrTo(s,g),S=s,s=g,g=S,--i<0&&(i=this.DB-1,--c)}return h.revert(s)}modInverse(t){var e=t.isEven();if(this.isEven()&&e||t.signum()==0)return f.ZERO;for(var i=t.clone(),r=this.clone(),s=O(1),h=O(0),n=O(0),o=O(1);i.signum()!=0;){for(;i.isEven();)i.rShiftTo(1,i),e?((!s.isEven()||!h.isEven())&&(s.addTo(this,s),h.subTo(t,h)),s.rShiftTo(1,s)):h.isEven()||h.subTo(t,h),h.rShiftTo(1,h);for(;r.isEven();)r.rShiftTo(1,r),e?((!n.isEven()||!o.isEven())&&(n.addTo(this,n),o.subTo(t,o)),n.rShiftTo(1,n)):o.isEven()||o.subTo(t,o),o.rShiftTo(1,o);i.compareTo(r)>=0?(i.subTo(r,i),e&&s.subTo(n,s),h.subTo(o,h)):(r.subTo(i,r),e&&n.subTo(s,n),o.subTo(h,o))}if(r.compareTo(f.ONE)!=0)return f.ZERO;if(o.compareTo(t)>=0)return o.subtract(t);if(o.signum()<0)o.addTo(t,o);else return o;return o.signum()<0?o.add(t):o}pow(t){return this.exp(t,new Bt)}gcd(t){var e=this.s<0?this.negate():this.clone(),i=t.s<0?t.negate():t.clone();if(e.compareTo(i)<0){var r=e;e=i,i=r}var s=e.getLowestSetBit(),h=i.getLowestSetBit();if(h<0)return e;for(s<h&&(h=s),h>0&&(e.rShiftTo(h,e),i.rShiftTo(h,i));e.signum()>0;)(s=e.getLowestSetBit())>0&&e.rShiftTo(s,e),(s=i.getLowestSetBit())>0&&i.rShiftTo(s,i),e.compareTo(i)>=0?(e.subTo(i,e),e.rShiftTo(1,e)):(i.subTo(e,i),i.rShiftTo(1,i));return h>0&&i.lShiftTo(h,i),i}isProbablePrime(t){var e,i=this.abs();if(i.t==1&&i[0]<=T[T.length-1]){for(e=0;e<T.length;++e)if(i[0]==T[e])return!0;return!1}if(i.isEven())return!1;for(e=1;e<T.length;){for(var r=T[e],s=e+1;s<T.length&&r<Nt;)r*=T[s++];for(r=i.modInt(r);e<s;)if(r%T[e++]==0)return!1}return i.millerRabin(t)}copyTo(t){for(var e=this.t-1;e>=0;--e)t[e]=this[e];t.t=this.t,t.s=this.s}fromInt(t){this.t=1,this.s=t<0?-1:0,t>0?this[0]=t:t<-1?this[0]=t+this.DV:this.t=0}fromString(t,e){var i;if(e==16)i=4;else if(e==8)i=3;else if(e==256)i=8;else if(e==2)i=1;else if(e==32)i=5;else if(e==4)i=2;else{this.fromRadix(t,e);return}this.t=0,this.s=0;for(var r=t.length,s=!1,h=0;--r>=0;){var n=i==8?+t[r]&255:rt(t,r);if(n<0){t.charAt(r)=="-"&&(s=!0);continue}s=!1,h==0?this[this.t++]=n:h+i>this.DB?(this[this.t-1]|=(n&(1<<this.DB-h)-1)<<h,this[this.t++]=n>>this.DB-h):this[this.t-1]|=n<<h,h+=i,h>=this.DB&&(h-=this.DB)}i==8&&+t[0]&128&&(this.s=-1,h>0&&(this[this.t-1]|=(1<<this.DB-h)-1<<h)),this.clamp(),s&&f.ZERO.subTo(this,this)}clamp(){for(var t=this.s&this.DM;this.t>0&&this[this.t-1]==t;)--this.t}dlShiftTo(t,e){var i;for(i=this.t-1;i>=0;--i)e[i+t]=this[i];for(i=t-1;i>=0;--i)e[i]=0;e.t=this.t+t,e.s=this.s}drShiftTo(t,e){for(var i=t;i<this.t;++i)e[i-t]=this[i];e.t=Math.max(this.t-t,0),e.s=this.s}lShiftTo(t,e){for(var i=t%this.DB,r=this.DB-i,s=(1<<r)-1,h=Math.floor(t/this.DB),n=this.s<<i&this.DM,o=this.t-1;o>=0;--o)e[o+h+1]=this[o]>>r|n,n=(this[o]&s)<<i;for(var o=h-1;o>=0;--o)e[o]=0;e[h]=n,e.t=this.t+h+1,e.s=this.s,e.clamp()}rShiftTo(t,e){e.s=this.s;var i=Math.floor(t/this.DB);if(i>=this.t){e.t=0;return}var r=t%this.DB,s=this.DB-r,h=(1<<r)-1;e[0]=this[i]>>r;for(var n=i+1;n<this.t;++n)e[n-i-1]|=(this[n]&h)<<s,e[n-i]=this[n]>>r;r>0&&(e[this.t-i-1]|=(this.s&h)<<s),e.t=this.t-i,e.clamp()}subTo(t,e){for(var i=0,r=0,s=Math.min(t.t,this.t);i<s;)r+=this[i]-t[i],e[i++]=r&this.DM,r>>=this.DB;if(t.t<this.t){for(r-=t.s;i<this.t;)r+=this[i],e[i++]=r&this.DM,r>>=this.DB;r+=this.s}else{for(r+=this.s;i<t.t;)r-=t[i],e[i++]=r&this.DM,r>>=this.DB;r-=t.s}e.s=r<0?-1:0,r<-1?e[i++]=this.DV+r:r>0&&(e[i++]=r),e.t=i,e.clamp()}multiplyTo(t,e){var i=this.abs(),r=t.abs(),s=i.t;for(e.t=s+r.t;--s>=0;)e[s]=0;for(s=0;s<r.t;++s)e[s+i.t]=i.am(0,r[s],e,s,0,i.t);e.s=0,e.clamp(),this.s!=t.s&&f.ZERO.subTo(e,e)}squareTo(t){for(var e=this.abs(),i=t.t=2*e.t;--i>=0;)t[i]=0;for(i=0;i<e.t-1;++i){var r=e.am(i,e[i],t,2*i,0,1);(t[i+e.t]+=e.am(i+1,2*e[i],t,2*i+1,r,e.t-i-1))>=e.DV&&(t[i+e.t]-=e.DV,t[i+e.t+1]=1)}t.t>0&&(t[t.t-1]+=e.am(i,e[i],t,2*i,0,1)),t.s=0,t.clamp()}divRemTo(t,e,i){var r=t.abs();if(!(r.t<=0)){var s=this.abs();if(s.t<r.t){e!=null&&e.fromInt(0),i!=null&&this.copyTo(i);return}i==null&&(i=l());var h=l(),n=this.s,o=t.s,u=this.DB-F(r[r.t-1]);u>0?(r.lShiftTo(u,h),s.lShiftTo(u,i)):(r.copyTo(h),s.copyTo(i));var v=h.t,p=h[v-1];if(p!=0){var c=p*(1<<this.F1)+(v>1?h[v-2]>>this.F2:0),m=this.FV/c,y=(1<<this.F1)/c,g=1<<this.F2,S=i.t,Z=S-v,A=e??l();for(h.dlShiftTo(Z,A),i.compareTo(A)>=0&&(i[i.t++]=1,i.subTo(A,i)),f.ONE.dlShiftTo(v,A),A.subTo(h,h);h.t<v;)h[h.t++]=0;for(;--Z>=0;){var Y=i[--S]==p?this.DM:Math.floor(i[S]*m+(i[S-1]+g)*y);if((i[S]+=h.am(0,Y,i,Z,0,v))<Y)for(h.dlShiftTo(Z,A),i.subTo(A,i);i[S]<--Y;)i.subTo(A,i)}e!=null&&(i.drShiftTo(v,e),n!=o&&f.ZERO.subTo(e,e)),i.t=v,i.clamp(),u>0&&i.rShiftTo(u,i),n<0&&f.ZERO.subTo(i,i)}}}invDigit(){if(this.t<1)return 0;var t=this[0];if(!(t&1))return 0;var e=t&3;return e=e*(2-(t&15)*e)&15,e=e*(2-(t&255)*e)&255,e=e*(2-((t&65535)*e&65535))&65535,e=e*(2-t*e%this.DV)%this.DV,e>0?this.DV-e:-e}isEven(){return(this.t>0?this[0]&1:this.s)==0}exp(t,e){if(t>4294967295||t<1)return f.ONE;var i=l(),r=l(),s=e.convert(this),h=F(t)-1;for(s.copyTo(i);--h>=0;)if(e.sqrTo(i,r),(t&1<<h)>0)e.mulTo(r,s,i);else{var n=i;i=r,r=n}return e.revert(i)}chunkSize(t){return Math.floor(Math.LN2*this.DB/Math.log(t))}toRadix(t){if(t==null&&(t=10),this.signum()==0||t<2||t>36)return"0";var e=this.chunkSize(t),i=Math.pow(t,e),r=O(i),s=l(),h=l(),n="";for(this.divRemTo(r,s,h);s.signum()>0;)n=(i+h.intValue()).toString(t).substr(1)+n,s.divRemTo(r,s,h);return h.intValue().toString(t)+n}fromRadix(t,e){this.fromInt(0),e==null&&(e=10);for(var i=this.chunkSize(e),r=Math.pow(e,i),s=!1,h=0,n=0,o=0;o<t.length;++o){var u=rt(t,o);if(u<0){t.charAt(o)=="-"&&this.signum()==0&&(s=!0);continue}n=e*n+u,++h>=i&&(this.dMultiply(r),this.dAddOffset(n,0),h=0,n=0)}h>0&&(this.dMultiply(Math.pow(e,h)),this.dAddOffset(n,0)),s&&f.ZERO.subTo(this,this)}fromNumber(t,e,i){if(typeof e=="number")if(t<2)this.fromInt(1);else for(this.fromNumber(t,i),this.testBit(t-1)||this.bitwiseTo(f.ONE.shiftLeft(t-1),q,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(e);)this.dAddOffset(2,0),this.bitLength()>t&&this.subTo(f.ONE.shiftLeft(t-1),this);else{var r=[],s=t&7;r.length=(t>>3)+1,e.nextBytes(r),s>0?r[0]&=(1<<s)-1:r[0]=0,this.fromString(r,256)}}bitwiseTo(t,e,i){var r,s,h=Math.min(t.t,this.t);for(r=0;r<h;++r)i[r]=e(this[r],t[r]);if(t.t<this.t){for(s=t.s&this.DM,r=h;r<this.t;++r)i[r]=e(this[r],s);i.t=this.t}else{for(s=this.s&this.DM,r=h;r<t.t;++r)i[r]=e(s,t[r]);i.t=t.t}i.s=e(this.s,t.s),i.clamp()}changeBit(t,e){var i=f.ONE.shiftLeft(t);return this.bitwiseTo(i,e,i),i}addTo(t,e){for(var i=0,r=0,s=Math.min(t.t,this.t);i<s;)r+=this[i]+t[i],e[i++]=r&this.DM,r>>=this.DB;if(t.t<this.t){for(r+=t.s;i<this.t;)r+=this[i],e[i++]=r&this.DM,r>>=this.DB;r+=this.s}else{for(r+=this.s;i<t.t;)r+=t[i],e[i++]=r&this.DM,r>>=this.DB;r+=t.s}e.s=r<0?-1:0,r>0?e[i++]=r:r<-1&&(e[i++]=this.DV+r),e.t=i,e.clamp()}dMultiply(t){this[this.t]=this.am(0,t-1,this,0,0,this.t),++this.t,this.clamp()}dAddOffset(t,e){if(t!=0){for(;this.t<=e;)this[this.t++]=0;for(this[e]+=t;this[e]>=this.DV;)this[e]-=this.DV,++e>=this.t&&(this[this.t++]=0),++this[e]}}multiplyLowerTo(t,e,i){var r=Math.min(this.t+t.t,e);for(i.s=0,i.t=r;r>0;)i[--r]=0;for(var s=i.t-this.t;r<s;++r)i[r+this.t]=this.am(0,t[r],i,r,0,this.t);for(var s=Math.min(t.t,e);r<s;++r)this.am(0,t[r],i,r,0,e-r);i.clamp()}multiplyUpperTo(t,e,i){--e;var r=i.t=this.t+t.t-e;for(i.s=0;--r>=0;)i[r]=0;for(r=Math.max(e-this.t,0);r<t.t;++r)i[this.t+r-e]=this.am(e-r,t[r],i,0,0,this.t+r-e);i.clamp(),i.drShiftTo(1,i)}modInt(t){if(t<=0)return 0;var e=this.DV%t,i=this.s<0?t-1:0;if(this.t>0)if(e==0)i=this[0]%t;else for(var r=this.t-1;r>=0;--r)i=(e*i+this[r])%t;return i}millerRabin(t){var e=this.subtract(f.ONE),i=e.getLowestSetBit();if(i<=0)return!1;var r=e.shiftRight(i);t=t+1>>1,t>T.length&&(t=T.length);for(var s=l(),h=0;h<t;++h){s.fromInt(T[Math.floor(Math.random()*T.length)]);var n=s.modPow(r,this);if(n.compareTo(f.ONE)!=0&&n.compareTo(e)!=0){for(var o=1;o++<i&&n.compareTo(e)!=0;)if(n=n.modPowInt(2,this),n.compareTo(f.ONE)==0)return!1;if(n.compareTo(e)!=0)return!1}}return!0}square(){var t=l();return this.squareTo(t),t}gcda(t,e){var i=this.s<0?this.negate():this.clone(),r=t.s<0?t.negate():t.clone();if(i.compareTo(r)<0){var s=i;i=r,r=s}var h=i.getLowestSetBit(),n=r.getLowestSetBit();if(n<0){e(i);return}h<n&&(n=h),n>0&&(i.rShiftTo(n,i),r.rShiftTo(n,r));var o=()=>{(h=i.getLowestSetBit())>0&&i.rShiftTo(h,i),(h=r.getLowestSetBit())>0&&r.rShiftTo(h,r),i.compareTo(r)>=0?(i.subTo(r,i),i.rShiftTo(1,i)):(r.subTo(i,r),r.rShiftTo(1,r)),i.signum()>0?setTimeout(o,0):(n>0&&r.lShiftTo(n,r),setTimeout(function(){e(r)},0))};setTimeout(o,10)}fromNumberAsync(t,e,i,r){if(typeof e=="number")if(t<2)this.fromInt(1);else{this.fromNumber(t,i),this.testBit(t-1)||this.bitwiseTo(f.ONE.shiftLeft(t-1),q,this),this.isEven()&&this.dAddOffset(1,0);var s=this,h=function(){s.dAddOffset(2,0),s.bitLength()>t&&s.subTo(f.ONE.shiftLeft(t-1),s),s.isProbablePrime(e)?setTimeout(function(){r()},0):setTimeout(h,0)};setTimeout(h,0)}else{var n=[],o=t&7;n.length=(t>>3)+1,e.nextBytes(n),o>0?n[0]&=(1<<o)-1:n[0]=0,this.fromString(n,256)}}}var Bt=function(){function a(){}return a.prototype.convert=function(t){return t},a.prototype.revert=function(t){return t},a.prototype.mulTo=function(t,e,i){t.multiplyTo(e,i)},a.prototype.sqrTo=function(t,e){t.squareTo(e)},a}(),ot=function(){function a(t){this.m=t}return a.prototype.convert=function(t){return t.s<0||t.compareTo(this.m)>=0?t.mod(this.m):t},a.prototype.revert=function(t){return t},a.prototype.reduce=function(t){t.divRemTo(this.m,null,t)},a.prototype.mulTo=function(t,e,i){t.multiplyTo(e,i),this.reduce(i)},a.prototype.sqrTo=function(t,e){t.squareTo(e),this.reduce(e)},a}(),ft=function(){function a(t){this.m=t,this.mp=t.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<t.DB-15)-1,this.mt2=2*t.t}return a.prototype.convert=function(t){var e=l();return t.abs().dlShiftTo(this.m.t,e),e.divRemTo(this.m,null,e),t.s<0&&e.compareTo(f.ZERO)>0&&this.m.subTo(e,e),e},a.prototype.revert=function(t){var e=l();return t.copyTo(e),this.reduce(e),e},a.prototype.reduce=function(t){for(;t.t<=this.mt2;)t[t.t++]=0;for(var e=0;e<this.m.t;++e){var i=t[e]&32767,r=i*this.mpl+((i*this.mph+(t[e]>>15)*this.mpl&this.um)<<15)&t.DM;for(i=e+this.m.t,t[i]+=this.m.am(0,r,t,e,0,this.m.t);t[i]>=t.DV;)t[i]-=t.DV,t[++i]++}t.clamp(),t.drShiftTo(this.m.t,t),t.compareTo(this.m)>=0&&t.subTo(this.m,t)},a.prototype.mulTo=function(t,e,i){t.multiplyTo(e,i),this.reduce(i)},a.prototype.sqrTo=function(t,e){t.squareTo(e),this.reduce(e)},a}(),Pt=function(){function a(t){this.m=t,this.r2=l(),this.q3=l(),f.ONE.dlShiftTo(2*t.t,this.r2),this.mu=this.r2.divide(t)}return a.prototype.convert=function(t){if(t.s<0||t.t>2*this.m.t)return t.mod(this.m);if(t.compareTo(this.m)<0)return t;var e=l();return t.copyTo(e),this.reduce(e),e},a.prototype.revert=function(t){return t},a.prototype.reduce=function(t){for(t.drShiftTo(this.m.t-1,this.r2),t.t>this.m.t+1&&(t.t=this.m.t+1,t.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);t.compareTo(this.r2)<0;)t.dAddOffset(1,this.m.t+1);for(t.subTo(this.r2,t);t.compareTo(this.m)>=0;)t.subTo(this.m,t)},a.prototype.mulTo=function(t,e,i){t.multiplyTo(e,i),this.reduce(i)},a.prototype.sqrTo=function(t,e){t.squareTo(e),this.reduce(e)},a}();at&&typeof D<"u"&&(D==null?void 0:D.appName)=="Microsoft Internet Explorer"?(f.prototype.am=pt,N=30):at&&(D==null?void 0:D.appName)!="Netscape"?(f.prototype.am=ct,N=26):(f.prototype.am=dt,N=28),f.prototype.DB=N,f.prototype.DM=(1<<N)-1,f.prototype.DV=1<<N;var j=52;f.prototype.FV=Math.pow(2,j),f.prototype.F1=j-N,f.prototype.F2=2*N-j;var H=[],k,w;for(k=48,w=0;w<=9;++w)H[k++]=w;for(k=97,w=10;w<36;++w)H[k++]=w;for(k=65,w=10;w<36;++w)H[k++]=w;f.ZERO=O(0),f.ONE=O(1);class mt{constructor(){this.i=0,this.j=0,this.S=[]}init(t){var e,i,r;for(e=0;e<256;++e)this.S[e]=e;for(i=0,e=0;e<256;++e)i=i+this.S[e]+t[e%t.length]&255,r=this.S[e],this.S[e]=this.S[i],this.S[i]=r;this.i=0,this.j=0}next(){var t;return this.i=this.i+1&255,this.j=this.j+this.S[this.i]&255,t=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=t,this.S[t+this.S[this.i]&255]}}var ut=256,z,B=null,E;if(B==null){B=[],E=0;var G=void 0;if(typeof window<"u"&&window!=null&&window.crypto&&window!=null&&window.crypto.getRandomValues){var _=new Uint32Array(256);for(window==null||window.crypto.getRandomValues(_),G=0;G<_.length;++G)B[E++]=_[G]&255}var J=function(a){if(this.count=this.count||0,this.count>=256||E>=ut){typeof window<"u"&&(window!=null&&window.removeEventListener?window==null||window.removeEventListener("mousemove",J,!1):window!=null&&window.detachEvent&&(window==null||window.detachEvent("onmousemove",J)));return}try{var t=a.x+a.y;B[E++]=t&255,this.count+=1}catch{}};typeof window<"u"&&(window!=null&&window.addEventListener?window==null||window.addEventListener("mousemove",J,!1):window!=null&&window.attachEvent&&(window==null||window.attachEvent("onmousemove",J)))}class X{constructor(){}nextBytes(t){for(var e=0;e<t.length;++e)t[e]=Tt()}}class wt{constructor(){this.n=null,this.e=0,this.d=null,this.p=null,this.q=null,this.dmp1=null,this.dmq1=null,this.coeff=null}doPublic(t){return t.modPowInt(this.e,this.n)}doPrivate(t){if(this.p==null||this.q==null)return t.modPow(this.d,this.n);for(var e=t.mod(this.p).modPow(this.dmp1,this.p),i=t.mod(this.q).modPow(this.dmq1,this.q);e.compareTo(i)<0;)e=e.add(this.p);return e.subtract(i).multiply(this.coeff).mod(this.p).multiply(this.q).add(i)}setPublic(t,e){t!=null&&e!=null&&t.length>0&&e.length>0?(this.n=d(t,16),this.e=parseInt(e,16)):console.error("Invalid RSA public key")}encrypt(t){var e=yt(t,this.n.bitLength()+7>>3);if(e==null)return null;var i=this.doPublic(e);if(i==null)return null;var r=i.toString(16);return r.length&1?"0"+r:r}encryptLong(t){var e=this,i=(this.n.bitLength()+7>>3)-11;try{var r="";if(t.length>i){var s=t.match(/.{1,117}/g);return s.forEach(function(o){var u=e.encrypt(o);r+=u}),W(r)}var h=this.encrypt(t),n=W(h);return n}catch{return!1}}decryptLong(t){var e=this,i=this.n.bitLength()+7>>3;t=et(t);try{if(t.length>i){var r="",s=t.match(/.{1,256}/g);return s.forEach(function(n){var o=e.decrypt(n);r+=o}),r}var h=this.decrypt(t);return h}catch{return!1}}setPrivate(t,e,i){t!=null&&e!=null&&t.length>0&&e.length>0?(this.n=d(t,16),this.e=parseInt(e,16),this.d=d(i,16)):console.error("Invalid RSA private key")}setPrivateEx(t,e,i,r,s,h,n,o){t!=null&&e!=null&&t.length>0&&e.length>0?(this.n=d(t,16),this.e=parseInt(e,16),this.d=d(i,16),this.p=d(r,16),this.q=d(s,16),this.dmp1=d(h,16),this.dmq1=d(n,16),this.coeff=d(o,16)):console.error("Invalid RSA private key")}generate(t,e){var i=new X,r=t>>1;this.e=parseInt(e,16);for(var s=new f(e,16);;){for(;this.p=new f(t-r,1,i),!(this.p.subtract(f.ONE).gcd(s).compareTo(f.ONE)==0&&this.p.isProbablePrime(10)););for(;this.q=new f(r,1,i),!(this.q.subtract(f.ONE).gcd(s).compareTo(f.ONE)==0&&this.q.isProbablePrime(10)););if(this.p.compareTo(this.q)<=0){var h=this.p;this.p=this.q,this.q=h}var n=this.p.subtract(f.ONE),o=this.q.subtract(f.ONE),u=n.multiply(o);if(u.gcd(s).compareTo(f.ONE)==0){this.n=this.p.multiply(this.q),this.d=s.modInverse(u),this.dmp1=this.d.mod(n),this.dmq1=this.d.mod(o),this.coeff=this.q.modInverse(this.p);break}}}decrypt(t){var e=d(t,16),i=this.doPrivate(e);return i==null?null:bt(i,this.n.bitLength()+7>>3)}generateAsync(t,e,i){var r=new X,s=t>>1;this.e=parseInt(e,16);var h=new f(e,16),n=this,o=()=>{var u=()=>{if(n.p.compareTo(n.q)<=0){var c=n.p;n.p=n.q,n.q=c}var m=n.p.subtract(f.ONE),y=n.q.subtract(f.ONE),g=m.multiply(y);g.gcd(h).compareTo(f.ONE)==0?(n.n=n.p.multiply(n.q),n.d=h.modInverse(g),n.dmp1=n.d.mod(m),n.dmq1=n.d.mod(y),n.coeff=n.q.modInverse(n.p),setTimeout(function(){i()},0)):setTimeout(o,0)},v=()=>{n.q=l(),n.q.fromNumberAsync(s,1,r,function(){n.q.subtract(f.ONE).gcda(h,function(c){c.compareTo(f.ONE)==0&&n.q.isProbablePrime(10)?setTimeout(u,0):setTimeout(v,0)})})},p=()=>{n.p=l(),n.p.fromNumberAsync(t-s,1,r,function(){n.p.subtract(f.ONE).gcda(h,function(c){c.compareTo(f.ONE)==0&&n.p.isProbablePrime(10)?setTimeout(v,0):setTimeout(p,0)})})};setTimeout(p,0)};setTimeout(o,0)}}class st extends wt{constructor(t=""){super(),t&&(typeof t=="string"?this.parseKey(t):(this.hasPrivateKeyProperty(t)||this.hasPublicKeyProperty(t))&&this.parsePropertiesFrom(t))}parseKey(t){try{var e=0,i=0,r=/^\s*(?:[0-9A-Fa-f][0-9A-Fa-f]\s*)+$/,s=r.test(t)?Dt.decode(t):$.unarmor(t),h=C.decode(s);if(h.sub.length===3&&(h=h.sub[2].sub[0]),h.sub.length===9){e=h.sub[1].getHexStringValue(),this.n=d(e,16),i=h.sub[2].getHexStringValue(),this.e=parseInt(i,16);var n=h.sub[3].getHexStringValue();this.d=d(n,16);var o=h.sub[4].getHexStringValue();this.p=d(o,16);var u=h.sub[5].getHexStringValue();this.q=d(u,16);var v=h.sub[6].getHexStringValue();this.dmp1=d(v,16);var p=h.sub[7].getHexStringValue();this.dmq1=d(p,16);var c=h.sub[8].getHexStringValue();this.coeff=d(c,16)}else if(h.sub.length===2){var m=h.sub[1],y=m.sub[0];e=y.sub[0].getHexStringValue(),this.n=d(e,16),i=y.sub[1].getHexStringValue(),this.e=parseInt(i,16)}else return!1;return!0}catch{return!1}}hasPublicKeyProperty(t){return t=t||{},t.hasOwnProperty("n")&&t.hasOwnProperty("e")}hasPrivateKeyProperty(t){return t=t||{},t.hasOwnProperty("n")&&t.hasOwnProperty("e")&&t.hasOwnProperty("d")&&t.hasOwnProperty("p")&&t.hasOwnProperty("q")&&t.hasOwnProperty("dmp1")&&t.hasOwnProperty("dmq1")&&t.hasOwnProperty("coeff")}parsePropertiesFrom(t){this.n=t.n,this.e=t.e,t.hasOwnProperty("d")&&(this.d=t.d,this.p=t.p,this.q=t.q,this.dmp1=t.dmp1,this.dmq1=t.dmq1,this.coeff=t.coeff)}}x=function(a){a=a||{},this.default_key_size=parseInt(a.default_key_size,10)||1024,this.default_public_exponent=a.default_public_exponent||"010001",this.log=a.log||!1,this.key=null},x.prototype.setKey=function(a){this.log&&this.key&&console.warn("A key was already set, overriding existing."),this.key=new st(a)},x.prototype.setPrivateKey=function(a){this.setKey(a)},x.prototype.setPublicKey=function(a){this.setKey(a)},x.prototype.decrypt=function(a){try{return this.getKey().decrypt(et(a))}catch{return!1}},x.prototype.encrypt=function(a){try{return W(this.getKey().encrypt(a))}catch{return!1}},x.prototype.encryptLong=function(a){try{for(var t=this.getKey().encryptLong(a)||"",e=this.getKey().decryptLong(t)||"",i=0,r=/null$/g;r.test(e)&&(i++,t=this.getKey().encryptLong(a)||"",e=this.getKey().decryptLong(t)||"",!(i>10)););return t}catch{return!1}},x.prototype.getKey=function(a){if(!this.key){if(this.key=new st,a&&{}.toString.call(a)==="[object Function]"){this.key.generateAsync(this.default_key_size,this.default_public_exponent,a);return}this.key.generate(this.default_key_size,this.default_public_exponent)}return this.key},x.version="3.1.4"}const Mt=({publicKey:D="",payload:b={}}={})=>{if(!D)return"";try{const P=St(b),q=new x;return q.setPublicKey(D),q.encryptLong(typeof P=="object"?JSON.stringify(P):P)}catch(P){console.error("encrypt error:",P)}return""};export{Mt as getEncryptInfo};
